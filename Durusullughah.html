<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Test Pemahaman Durusullughah</title>

<!-- Google Fonts (Poppins for Latin, Amiri for Arabic) -->
<link href="https://fonts.googleapis.com/css2?family=Amiri&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- Tailwind & Lib -->
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

<style>
/* Use Poppins for Latin by default; Amiri is available as fallback for Arabic glyphs */
body { font-family: 'Poppins', 'Amiri', sans-serif; background:#f4f6f8; margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; }
.quiz-container { width:95%; max-width:700px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.15); overflow:hidden; background:#fff; }
.hidden { display:none; }
.progress { height:10px; background:#eee; border-radius:10px; overflow:hidden; margin-bottom:20px; }
.progress-bar { height:100%; background: linear-gradient(90deg,#00c6ff,#0072ff); width:0%; transition:width .3s ease; }

.answers button {
  display: block;
  width: 100%;
  margin: 8px 0;
  padding: 10px;
  border: 2px solid #3498db;
  background: #fff;
  border-radius: 12px;
  cursor: pointer;
  font-size: 15px;
  transition: .25s;
  outline: none; /* hilangkan outline */
  box-shadow: none; /* hilangkan sorotan */
  -webkit-tap-highlight-color: transparent; /* hilangkan highlight di mobile/Chrome */
}
.answers button:hover {
  background: #3498db;
  color: #fff;
}
.answers button.correct {
  background: #2ecc71;
  color: #fff;
  border-color: #2ecc71;
}
.answers button.wrong {
  background: #e74c3c;
  color: #fff;
  border-color: #e74c3c;
}
.answers button:focus {
  outline: none;
  box-shadow: none;
}

.explanation { background:#f0f8ff; border-left:4px solid #0078ff; padding:10px; border-radius:10px; margin-top:10px; font-size:14px; }

/* Arabic text styling: use Amiri and right-to-left layout */
.arab, :lang(ar) {
  font-family: 'Amiri', serif;
  direction: rtl;
  text-align: right;
  display: block;
}

/* Ensure Arabic inside answer buttons aligns right and uses full width */
.answers button .arab {
  display: block;
  width: 100%;
  text-align: right;
}
</style>
</head>
<body>

<div class="quiz-container">

  <!-- Intro -->
  <div id="intro" style="position:relative;text-align:center;">
    <img src="./1.png" alt="Sampul Kuis" style="width:100%;max-width:700px;display:block;margin:auto;filter:brightness(60%);">
    <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,0.78);backdrop-filter:blur(8px);padding:30px;border-radius:20px;width:84%;max-width:420px;">
      <h1 style="font-size:22px;margin-bottom:8px;">Tes Pemahaman Bahasa Arab</h1>
      <div class="sub" style="font-size:13px;margin-bottom:15px;"><i>Kitab Durusullughah</i></div>
      <input type="text" id="name" placeholder="Nama Antum" style="width:100%;padding:12px;margin-bottom:12px;border-radius:12px;border:1.5px solid #ccc;">
      <input type="text" id="region" placeholder="Daerah Antum" style="width:100%;padding:12px;margin-bottom:12px;border-radius:12px;border:1.5px solid #ccc;">
      <button id="btnStart" style="background:linear-gradient(135deg,#3a7bd5,#00d2ff);color:#fff;border:none;padding:12px 24px;border-radius:12px;width:100%;">Mulai Test</button>
    </div>
    <footer style="position:absolute;bottom:8px;width:100%;color:#eee;font-size:13px;">¬© Arif Abd Rohim </footer>
  </div>

  <!-- Quiz -->
  <div id="quiz" class="hidden p-5">
    <div class="progress"><div class="progress-bar" id="progress-bar"></div></div>
    <div id="question-container"></div>
    <div class="text-center mt-5">
      <button id="nextBtn" class="hidden px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition transform hover:scale-105 text-sm">‚û°Ô∏è Lanjut</button>
    </div>
  </div>

  <!-- Result Page -->
  <div id="result" class="hidden min-h-screen bg-cover bg-center bg-no-repeat flex items-center justify-center relative" style="background-image:url('2.png');">
    <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-transparent to-black/70"></div>
    <div class="relative z-10 bg-white/95 backdrop-blur-sm shadow-2xl border border-gray-200 rounded-3xl p-7 w-[360px] text-center">
      <h1 class="text-2xl font-extrabold text-gray-900 mb-4 tracking-wide uppercase">üéñÔ∏è Hasil Nilai</h1>
      <p class="text-gray-500 mb-5 text-xs italic">Test Pemahaman Bahasa Arab</p>

      <div class="flex justify-center mb-6">
        <div id="scoreCircle" class="w-24 h-24 rounded-full bg-gradient-to-tr from-yellow-400 via-orange-400 to-pink-500 flex items-center justify-center text-white text-4xl font-extrabold shadow-lg">0</div>
      </div>

      <div class="space-y-2 text-left text-gray-700 text-sm">
        <div class="flex justify-between"><span>Nama</span><span id="resName">-</span></div>
        <div class="flex justify-between"><span>Asal</span><span id="resRegion">-</span></div>
      </div>

      <div class="mt-4 border-t border-gray-300 pt-3">
        <p id="resComment" class="text-gray-700 italic text-xs">‚ÄúKerja kerasmu patut diacungi jempol.‚Äù</p>
      </div>

      <div id="loadingText" class="mt-4 text-xs text-gray-600 italic">‚è≥ tombol di bawah akan aktif setelah 10 detik...</div>

      <div class="mt-6 flex flex-col gap-2">
        <button id="btnRaport" disabled class="px-6 py-2 bg-gradient-to-r from-green-600 to-teal-500 text-white font-semibold rounded-full shadow-md transition transform hover:scale-105 text-sm">üìä Lihat Raport Teman-Teman</button>
        <button id="btnBack" class="px-6 py-2 bg-gradient-to-r from-indigo-600 to-blue-500 hover:from-indigo-700 hover:to-blue-600 text-white font-semibold rounded-full shadow-md transition transform hover:scale-105 text-sm">üîÅ Kembali</button>
      </div>
    </div>
  </div>

  <!-- Raport Teman-Teman Page -->
  <div id="raportPage" class="hidden p-6 text-center bg-white min-h-[500px] rounded-2xl">
    <h1 class="text-2xl font-bold mb-3">üìñ Raport Teman-Teman</h1>
    <p class="text-sm text-gray-600 mb-5" id="raportNotice">Berikut daftar nilai seluruh peserta test Bahsa Arab:</p>
    <div id="raportList" class="text-left text-sm bg-gray-50 rounded-xl p-4 max-h-[400px] overflow-y-auto border border-gray-200"></div>
    <button id="btnBackToResult" class="mt-5 px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-500 text-white rounded-full shadow-md hover:scale-105 transition text-sm">‚¨ÖÔ∏è Kembali ke Hasil</button>
  </div>

</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyVhUYG_3DcR_WdDyqJ0dF6VWQpD1k6JPkFUJ1d5qzAGDEwaLMKHJ50OZn5THAV-aMS8A/exec";
const questions = [
  {
    q: "..........ÿü ŸÜŸéÿπŸéŸÖŸí ÿ™ŸêŸÑŸíŸÉŸé ŸÖŸêŸÉŸíŸÜŸéÿ≥Ÿéÿ©Ÿå",
    options: [
      "ŸáŸéŸÑŸí ŸáŸ∞ÿ∞Ÿéÿß ŸÉŸêÿ™Ÿéÿßÿ®Ÿåÿü",
      "ŸáŸéŸÑŸí ŸáŸ∞ÿ∞ŸêŸáŸê ŸÖŸêŸÉŸíŸÜŸéÿ≥Ÿéÿ©Ÿåÿü",
      "ÿ£ŸéŸáŸ∞ÿ∞ŸêŸáŸê ÿ∑ŸéÿßŸàŸêŸÑŸéÿ©Ÿåÿü",
      "ŸáŸéŸÑŸí ŸáŸ∞ÿ∞Ÿéÿß ŸÇŸéŸÑŸéŸÖŸåÿü"
    ],
    a: 1,
    exp: "Karena jawabannya menggunakan ŸÜÿπŸÖ (ya/tidak) dan kata ÿ™ŸÑŸÉ menunjukkan muannats, maka pertanyaan yang sesuai adalah ŸáŸéŸÑŸí ŸáŸ∞ÿ∞ŸêŸáŸê ŸÖŸêŸÉŸíŸÜŸéÿ≥Ÿéÿ©Ÿå."
  },
  {
    q: "ŸÖŸéÿßÿ∞Ÿéÿß ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿ≠Ÿéÿßÿ¶Ÿêÿ∑Ÿêÿü",
    options: [
      "ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿ≠Ÿéÿßÿ¶Ÿêÿ∑Ÿê ÿ≥ŸéÿßÿπŸéÿ©Ÿå",
      "ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿ≠Ÿéÿßÿ¶Ÿêÿ∑Ÿê ŸÖŸèÿ≠ŸéŸÖŸëŸéÿØŸå",
      "ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿ≠Ÿéÿßÿ¶Ÿêÿ∑Ÿê ÿ£ŸéŸÜŸéÿß",
      "ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸíÿ≠Ÿéÿßÿ¶Ÿêÿ∑Ÿê ŸÉŸêÿ™Ÿéÿßÿ®Ÿå"
    ],
    a: 0,
    exp: "ŸÖÿßÿ∞ÿß digunakan untuk menanyakan benda tidak berakal, sehingga jawaban yang tepat adalah ÿ≥ÿßÿπÿ©."
  },
  {
    q: "...... ÿßŸÑŸíŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸê ŸÖŸêŸÜŸíÿ®Ÿéÿ±Ÿå",
    options: ["ÿπŸéŸÑŸéŸâ", "ŸÅŸêŸä", "ÿ•ŸêŸÑŸéŸâ", "ŸÖŸêŸÜŸí"],
    a: 1,
    exp: "Karena mimbar berada di dalam masjid, maka huruf jar yang tepat adalah ŸÅŸä."
  },
  {
    q: "......ÿü ŸÑŸéÿß ÿ®ŸéŸÑŸí ŸáŸèŸàŸé ŸÅŸêŸä ÿßŸÑŸíÿ®ŸéŸäŸíÿ™Ÿê",
    options: [
      "ÿ£ŸéŸäŸíŸÜŸé ÿßŸÑŸíŸÉŸêÿ™Ÿéÿßÿ®Ÿèÿü",
      "ŸáŸéŸÑŸí ŸÖŸèÿ≠ŸéŸÖŸëŸéÿØŸå ŸÅŸêŸä ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿêÿü",
      "ŸáŸéŸÑŸí ŸÅŸéÿßÿ∑ŸêŸÖŸéÿ©Ÿè ŸÅŸêŸä ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿêÿü",
      "ŸáŸéŸÑŸí ŸÖŸèÿ≠ŸéŸÖŸëŸéÿØŸè ŸÅŸêŸä ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿêÿü"
    ],
    a: 1,
    exp: "Dhamir ŸáŸà menunjukkan laki-laki, sehingga subjek yang sesuai adalah ŸÖÿ≠ŸÖÿØ dan ŸÖÿ≠ŸÖÿØ tidak termasuk isim yang tidak bisa ditanwin."
  },
  {
    q: "ŸÑŸêŸÖŸéŸÜŸí ÿ™ŸêŸÑŸíŸÉŸé ÿßŸÑŸíÿÆŸéÿ±ŸêŸäÿ∑Ÿéÿ©Ÿèÿü",
    options: [
      "ŸáŸ∞ÿ∞ŸêŸáŸê ÿÆŸéÿ±ŸêŸäÿ∑Ÿéÿ©Ÿå",
      "ŸáŸêŸäŸé ÿ¨ŸéŸÖŸêŸäŸÑŸéÿ©Ÿå",
      "ŸáŸêŸäŸé ŸÑŸêÿ£Ÿéÿ≠ŸíŸÖŸéÿØŸé",
      "ŸáŸêŸäŸé ŸÑŸêŸÑŸíŸÅŸéÿµŸíŸÑŸê"
    ],
    a: 2,
    exp: "ŸÑŸêŸÖŸéŸÜŸí digunakan untuk menanyakan kepemilikan makhluk berakal."
  },
  {
    q: "......ÿü ÿ®Ÿêÿ¨ŸéÿßŸÜŸêÿ®ŸêŸáŸê ÿ®Ÿêÿ¶Ÿíÿ±Ÿå ŸàŸéÿ≠ŸéŸÖŸëŸéÿßŸÖŸå",
    options: [
      "ŸÖŸéÿßÿ∞Ÿéÿß ÿ®Ÿêÿ¨ŸéÿßŸÜŸêÿ®Ÿê ÿßŸÑŸíŸÅŸéÿµŸíŸÑŸêÿü",
      "ŸÖŸéÿß ŸáŸ∞ÿ∞Ÿéÿßÿü",
      "ŸÖŸéŸÜŸí ÿ®Ÿêÿ¨ŸéÿßŸÜŸêÿ®Ÿê ÿßŸÑŸíŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸêÿü",
      "ŸÖŸéÿ™ŸéŸâ ÿßŸÑÿ≥ŸëŸèŸàŸÇŸèÿü"
    ],
    a: 0,
    exp: "Jawaban berupa benda tidak berakal, sehingga kata tanya yang tepat adalah ŸÖÿßÿ∞ÿß."
  },
  {
    q: "ŸÉŸéŸàŸëŸêŸÜŸê ÿßŸÑŸíÿ¨ŸèŸÖŸíŸÑŸéÿ©Ÿé ÿßŸÑŸíŸÖŸèŸÅŸêŸäÿØŸéÿ©Ÿé ŸÖŸêŸÜŸé ÿßŸÑŸíŸÉŸéŸÑŸêŸÖŸéÿßÿ™Ÿê ÿßŸÑŸíÿ¢ÿ™ŸêŸäŸéÿ©Ÿê:  ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿê ‚Äì ŸÅŸêŸä ‚Äì ÿ£Ÿéÿ≠ŸíŸÖŸéÿØ ‚Äì ŸáŸ∞ÿ∞ŸêŸáŸê ‚Äì ÿπŸéŸÑŸêŸäŸë ‚Äì ŸàŸé ‚Äì ÿ™ŸêŸÑŸíŸÖŸêŸäÿ∞ŸéÿßŸÜŸê ",
    options: [
      "ÿ£Ÿéÿ≠ŸíŸÖŸéÿØŸè ŸàŸéÿπŸéŸÑŸêŸäŸëŸå ÿ™ŸêŸÑŸíŸÖŸêŸäÿ∞ŸéÿßŸÜŸê ŸÅŸêŸä ŸáŸ∞ÿ∞ŸêŸáŸê ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿê",
      "ŸÅŸêŸä ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿê ŸáŸ∞ÿ∞ŸêŸáŸê ÿ™ŸêŸÑŸíŸÖŸêŸäÿ∞ŸéÿßŸÜŸê ÿ£Ÿéÿ≠ŸíŸÖŸéÿØŸè",
      "ŸáŸ∞ÿ∞ŸêŸáŸê ÿ£Ÿéÿ≠ŸíŸÖŸéÿØŸè ŸÅŸêŸä ÿπŸéŸÑŸêŸäŸë ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿê",
      "ÿ™ŸêŸÑŸíŸÖŸêŸäÿ∞ŸéÿßŸÜŸê ÿßŸÑŸíŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©Ÿê ŸÅŸêŸä ŸáŸ∞ÿ∞ŸêŸáŸê"
    ],
    a: 0,
    exp: "Pilihan ini membentuk jumlah mufidah yang benar dan sesuai kaidah nahwu."
  },
  {
    q: "ÿπŸèŸÖŸèÿ±Ÿè ÿ£ŸéÿÆŸêŸä ÿßŸÑÿµŸëŸéÿ∫ŸêŸäÿ±Ÿê ..... ÿ≥ŸéŸÜŸéŸàŸéÿßÿ™Ÿç ŸàŸé ...... ÿ£Ÿéÿ¥ŸíŸáŸèÿ±Ÿç",
    options: [
      "ÿ´ŸéŸÑŸéÿßÿ´Ÿè ‚Äì ÿÆŸéŸÖŸíÿ≥Ÿéÿ©Ÿé ÿπŸéÿ¥Ÿéÿ±Ÿé",
      "ÿ´ŸéŸÑŸéÿßÿ´Ÿéÿ©Ÿè ‚Äì ÿÆŸéŸÖŸíÿ≥Ÿå",
      "ÿ´ŸéŸÑŸéÿßÿ´Ÿè ‚Äì ÿÆŸéŸÖŸíÿ≥Ÿå",
      "ÿ´ŸéŸÑŸéÿßÿ´Ÿè ‚Äì ÿÆŸéŸÖŸíÿ≥Ÿéÿ©Ÿè"
    ],
    a: 3,
    exp: "ÿ≥ŸÜŸàÿßÿ™ jamak muannats ‚Üí bilangannya mudzakkar, sedangkan ÿ£ÿ¥Ÿáÿ± mudzakkar ‚Üí bilangannya muannats."
  },
  {
    q: "ŸÉŸéŸÖŸí ÿ¨Ÿéÿ≤ŸêŸäÿ±Ÿéÿ©Ÿã ŸÅŸêŸä ÿ•ŸêŸÜŸíÿØŸèŸàŸÜŸêŸäÿ≥ŸêŸäŸéÿßÿü",
    options: [
      "ÿ¨Ÿéÿ≤ŸêŸäÿ±Ÿéÿ©Ÿå ŸÉŸéÿ´ŸêŸäÿ±Ÿéÿ©Ÿå",
      "ÿ¨Ÿèÿ≤Ÿèÿ±Ÿå ŸÉŸéÿ´ŸêŸäÿ±Ÿå",
      "ŸáŸêŸäŸé ŸÉŸéÿ´ŸêŸäÿ±Ÿå",
      "ÿ¨Ÿèÿ≤Ÿèÿ±Ÿå ŸÉŸéÿ´ŸêŸäÿ±Ÿéÿ©Ÿå"
    ],
    a: 3,
    exp: "ÿ¨ÿ≤ÿ± adalah jamak taksir yang diperlakukan sebagai muannats."
  },
  {
    q: "ÿ£ŸéŸäŸíŸÜŸé ...... ÿßŸÑŸíÿπŸéÿßŸÑŸêŸäŸéÿ©Ÿèÿü",
    options: ["ÿßŸÑŸíÿ¨Ÿêÿ®ŸéÿßŸÑŸè", "ÿßŸÑŸíÿ¨Ÿéÿ®ŸéŸÑŸè", "ÿßŸÑŸíŸÇŸéŸÑŸéŸÖŸè", "ŸÖŸèÿ≠ŸéŸÖŸëŸéÿØŸå"],
    a: 0,
    exp: "ÿßŸÑÿπÿßŸÑŸäÿ© muannats dan sesuai dengan ÿßŸÑÿ¨ÿ®ÿßŸÑ."
  },
  {
    q: "ÿ£ŸéŸäŸëŸèŸáŸèŸÖŸéÿß ÿ£Ÿéÿ®Ÿíÿ∑Ÿéÿ£Ÿèÿü ÿßŸÑÿ≥ŸëŸéŸÅŸêŸäŸÜŸéÿ©Ÿè ÿ£ŸéŸÖŸê ÿßŸÑŸíŸÇŸêÿ∑Ÿéÿßÿ±Ÿèÿü",
    options: [
      "ÿßŸÑŸíŸÇŸêÿ∑Ÿéÿßÿ±Ÿè ÿ£Ÿéÿ®Ÿíÿ∑Ÿéÿ£Ÿè",
      "ÿßŸÑÿ≥ŸëŸéŸÅŸêŸäŸÜŸéÿ©Ÿè ÿ£Ÿéÿ®Ÿíÿ∑Ÿéÿ£Ÿè ŸÖŸêŸÜŸé ÿßŸÑŸíŸÇŸêÿ∑Ÿéÿßÿ±Ÿê",
      "ŸáŸèŸÖŸéÿß ÿ≥ŸéŸàŸéÿßÿ°Ÿå",
      "ŸÑŸéÿß ÿ£ŸéÿØŸíÿ±ŸêŸä"
    ],
    a: 1,
    exp: "Bentuk tafdhil yang benar adalah ÿ£ÿ®ÿ∑ÿ£ ŸÖŸÜ."
  },
  {
    q: "..... ÿ£Ÿéÿ∫ŸíŸÑŸéŸâ ŸÖŸêŸÜŸí ......",
    options: [
      "ŸÅŸéÿßÿ∑ŸêŸÖŸéÿ©Ÿè ‚Äì ÿ£ŸéŸÜŸéÿß",
      "ÿßŸÑŸíŸÉŸêÿ™Ÿéÿßÿ®Ÿè ‚Äì ÿßŸÑŸíŸÇŸéŸÑŸéŸÖŸê",
      "ŸÅŸêŸä ‚Äì ŸÖŸêŸÜŸí",
      "ŸáŸ∞ÿ∞Ÿéÿß ‚Äì ŸáŸêŸäŸé"
    ],
    a: 1,
    exp: "Isim yang dibandingkan harus logis secara makna."
  },
  {
    q: "ŸÑŸéŸàŸíŸÜŸè ÿßŸÑÿ≥ŸëŸéÿ®ŸëŸèŸàÿ±Ÿéÿ©Ÿê .......",
    options: ["ÿ≥ŸéŸàŸíÿØŸéÿßÿ°Ÿå", "ÿ£Ÿéÿ≥ŸíŸàŸéÿØŸå", "ÿ£Ÿéÿ≥ŸíŸàŸéÿØŸè", "ÿ≥ŸéŸàŸíÿØŸéÿßÿ°Ÿå"],
    a: 2,
    exp: "ÿ£Ÿéÿ≥ŸíŸàŸéÿØŸè adalah khabar bagi ŸÑŸàŸÜ yang mudzakkar dan dia tanpa tanwin."
  },
  {
    q: "ÿßŸÑÿ≥ŸëŸéÿ®ŸëŸèŸàÿ±Ÿéÿ©Ÿè ....... ",
    options: ["ÿ£Ÿéÿ≥ŸíŸàŸéÿØŸè", "ÿ≥ŸéŸàŸíÿØŸéÿßÿ°Ÿå", "ÿ≥ŸéŸàŸíÿØŸéÿßÿ°Ÿè", "ÿ£Ÿéÿ≥ŸíŸàŸéÿØŸå"],
    a: 2,
    exp: "ÿßŸÑÿ≥ÿ®Ÿàÿ±ÿ© muannats, maka khabarnya adalah ÿ≥ŸàÿØÿßÿ° tanpa tanwin."
  },
  {
    q: "ÿßŸÑŸíŸÇŸéŸÑŸéŸÖŸè .......",
    options: ["ÿ£Ÿéÿ≤Ÿíÿ±ŸéŸÇŸè", "ÿ£Ÿéÿ≤Ÿíÿ±ŸéŸÇŸå", "ÿ≤Ÿéÿ±ŸíŸÇŸéÿßÿ°Ÿè", "ÿ≤Ÿéÿ±ŸíŸÇŸéÿßÿ°Ÿå"],
    a: 0,
    exp: "ÿßŸÑŸÇŸÑŸÖ mudzakkar dan khabarnya warna yang mengikuti mudzakkarnya serta tanpa tanwin."
  },
  {
    q: "ŸáŸéŸÑŸê ÿßŸÑŸíŸÖŸêŸÜŸíÿØŸêŸäŸÑŸè ŸÑŸêŸÑŸíŸÉŸéÿ¥ŸëŸéÿßŸÅŸê ŸÖŸèÿ±Ÿéÿ®ŸëŸéÿπŸåÿü",
    options: [
      "ŸÜŸéÿπŸéŸÖŸí ŸáŸèŸàŸé ŸÖŸèÿ±Ÿéÿ®ŸëŸéÿπŸå",
      "ŸÜŸéÿπŸéŸÖŸí ŸáŸêŸäŸé ŸÖŸèÿ±Ÿéÿ®ŸëŸéÿπŸå",
      "ŸÑŸéÿß ŸáŸèŸàŸé ŸÖŸèÿ±Ÿéÿ®ŸëŸéÿπŸå",
      "ŸÑŸéÿß ŸáŸêŸäŸé ŸÖŸèÿ±Ÿéÿ®ŸëŸéÿπŸå"
    ],
    a: 0,
    exp: "ÿßŸÑŸÖŸÜÿØŸäŸÑ mudzakkar, sehingga dhamir dan sifatnya mudzakkar."
  },
  {
    q: "........ ÿ™Ÿèÿ∫ŸíŸÑŸêŸÇŸè ÿßŸÑŸÜŸëŸéÿßŸÅŸêÿ∞Ÿéÿ©Ÿé",
    options: ["ŸÅŸéŸÇŸêŸäŸáŸå", "ÿ£ŸéŸÜŸíÿ™Ÿé", "ŸÅŸéÿßÿ∑ŸêŸÖŸéÿ©Ÿè", "B dan C benar"],
    a: 3,
    exp: "Baik ÿ£ŸÜÿ™Ÿé maupun ŸÅÿßÿ∑ŸÖÿ© menggunakan ÿ™ÿßÿ° ÿßŸÑŸÖÿ∂ÿßÿ±ÿπÿ©."
  }
];


let currentQuestion=0, score=0, userName='', userRegion='', allData=[], dataReady=false;

document.getElementById('btnStart').addEventListener('click', startQuiz);
document.getElementById('btnBack').addEventListener('click', ()=>location.reload());
document.getElementById('btnRaport').addEventListener('click', showRaport);
document.getElementById('btnBackToResult').addEventListener('click', ()=>{
  document.getElementById('raportPage').classList.add('hidden');
  document.getElementById('result').classList.remove('hidden');
});
document.getElementById('nextBtn').addEventListener('click', ()=>{
  currentQuestion++;
  if(currentQuestion < questions.length) loadQuestion();
  else showResult();
});

function startQuiz(){
  userName = document.getElementById('name').value.trim();
  userRegion = document.getElementById('region').value.trim();
  if(!userName || !userRegion){ alert('Nama dan daerah harus diisi!'); return; }
  document.getElementById('intro').classList.add('hidden');
  document.getElementById('quiz').classList.remove('hidden');
  loadQuestion();
}

// helper: if text contains Arabic characters, wrap with span.arab so CSS can apply Amiri + RTL
function wrapIfArabic(text){
  try{
    if(/[\u0600-\u06FF]/.test(text)) return `<span class="arab" dir="rtl">${text}</span>`;
  }catch(e){ }
  return text;
}

function loadQuestion(){
  const q = questions[currentQuestion];
  document.getElementById('question-container').innerHTML = `
    <div class="mb-3 font-semibold" style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px;">
      <div class="qnum">${currentQuestion+1}.</div>
      <div style="flex:1;">${wrapIfArabic(q.q)}</div>
    </div>
    <div class="answers">
      ${q.options.map((opt,i)=>`
        <button onclick="selectAnswer(${i}, this)" class="focus:outline-none active:bg-white">${wrapIfArabic(opt)}</button>
      `).join('')}
    </div>
    <div class="explanation hidden" id="exp-${currentQuestion}">${q.exp}</div>
  `;
  document.getElementById('progress-bar').style.width = ((currentQuestion)/questions.length)*100 + '%';
  document.getElementById('nextBtn').classList.add('hidden');
}

window.selectAnswer = function(i, btn){
  const q = questions[currentQuestion];
  const btns = document.querySelectorAll('.answers button');
  btns.forEach((b, idx) => {
    b.disabled = true;
    if(idx === q.a) b.classList.add('correct');
    else if(idx === i) b.classList.add('wrong');
  });
  if(i === q.a) score++;
  document.getElementById(`exp-${currentQuestion}`).classList.remove('hidden');
  document.getElementById('nextBtn').classList.remove('hidden');
}

async function showResult(){
  document.getElementById('quiz').classList.add('hidden');
  document.getElementById('result').classList.remove('hidden');
  document.getElementById('resName').innerText = userName;
  document.getElementById('resRegion').innerText = userRegion;

  const percentage = Math.round((score/questions.length)*100);
  const scoreEl = document.getElementById('scoreCircle');
  let c=0; const timer=setInterval(()=>{c++;scoreEl.textContent=c;if(c>=percentage){clearInterval(timer);confetti();}},20);

  let comment='';
  if(percentage===100) comment='üåü Antum <b>Mumtaz</b>! Pemahaman antum luar biasa.';
  else if(percentage>=70) comment='‚ú® Nilai antum <b>Jayyid!</b>';
  else if(percentage>=50) comment='üìò Nilai antum <b>maqbul</b>, belajar lagi ya.';
  else comment='üìñ Antum <b>Rasib</b>! Coba lagi.';

// <== Ganti innerText ke innerHTML
document.getElementById('resComment').innerHTML = comment;


  document.getElementById('loadingText').style.display = 'block';
  document.getElementById('btnRaport').disabled = true;
  dataReady = false;

  // Simpan data ke Google Sheet
  await fetch(SCRIPT_URL, { method:'POST', body:JSON.stringify({ name:userName, region:userRegion, score:percentage }) });

  // Ambil data untuk raport
  try {
    const res = await fetch(SCRIPT_URL);
    const data = await res.json();
    allData = (Array.isArray(data)?data:data.participants||[])
      .map(r => ({ name:r.name||r[0]||'-', region:r.region||r[1]||'-', score:Number(r.score||r[2]||0) }))
      .sort((a,b)=>b.score-a.score);
    dataReady = true;
    document.getElementById('btnRaport').disabled = false;
  } catch {
    allData = [];
    dataReady = false;
  }

  document.getElementById('loadingText').style.display = 'none';
}

function showRaport(){
  if(!dataReady){
    document.getElementById('raportList').innerHTML = '‚è≥ Tombol di bawah akan aktif setelah 10 detik...';
    return;
  }
  document.getElementById('result').classList.add('hidden');
  document.getElementById('raportPage').classList.remove('hidden');

  const raportHTML = allData.map((p,i)=> {
  // Tandai hanya peserta yang login terakhir (nama, region, score sama)
  const isCurrentUser = p.name === userName && p.region === userRegion && p.score === Math.round((score/questions.length)*100);
  return `
  <div class="flex justify-between border-b border-gray-200 py-1">
    <span>
      ${i+1}. 
      <b class="${isCurrentUser ? 'text-green-600 underline' : ''}">${p.name}</b> 
      (${p.region})
    </span>
    <span class="font-semibold">${p.score}%</span>
  </div>
  `;
}).join('');
  document.getElementById('raportList').innerHTML = raportHTML;
}
</script>
</body>
</html>


